# =============================================================================
# SAE Models Configuration
# =============================================================================
#
# Structure:
#   sae_models (list) → layers (list) → concepts (list)
#
# =============================================================================

config:
  base_model:
    id: "sd-v1.5"
    model_id: "sd-legacy/stable-diffusion-v1-5"

sae_models:
  - id: "nudity_topk32"
    name: "Nudity SAE (Top-K 32)"
    
    hyperparameters:
      topk: 32
      learning_rate: 1.0e-3
      warmup_steps: 100000
      auxiliary_loss: 0.0625
      epochs: 2
      batch_size: 4096
      nb_concepts: 46080
    
    model_dir: "models/sd-v1-5/sae/exp36_topk32"
    layer_id: "UNET_UP_1_ATT_1"
    
    concepts:
      - id: "exposed_anus"
        name: "anus"
        description: "Visible anus without clothing coverage"
      - id: "exposed_armpits"
        name: "armpits"
        description: "Uncovered underarm area"
      - id: "exposed_belly"
        name: "belly"
        description: "Bare stomach or abdominal area"
      - id: "exposed_buttocks"
        name: "buttocks"
        description: "Visible buttocks without clothing"
      - id: "exposed_feet"
        name: "feet"
        description: "Bare feet without shoes or socks"
      - id: "exposed_breast"
        name: "female breast"
        description: "Visible female breast without coverage"
      - id: "male_breast"
        name: "male breast"
        description: "Male chest area"
      - id: "exposed_vagina"
        name: "female genitalia"
        description: "Visible female genitalia"
      - id: "exposed_penis"
        name: "male genitalia"
        description: "Visible male genitalia"
      # - id: "belly"
      #   name: "belly"
      #   description: "Clothed or partially covered stomach area"
      # - id: "buttocks"
      #   name: "buttocks"
      #   description: "Clothed or partially covered rear area"
      # - id: "feet"
      #   name: "feet"
      #   description: "Covered feet with shoes or socks"
      # - id: "breast"
      #   name: "breast"
      #   description: "Covered or partially clothed breast area"
      # - id: "vagina"
      #   name: "vagina"
      #   description: "Covered female genital area"
      - id: "female_face"
        name: "female face"
        description: "Facial features identifying female person"
      - id: "male_face"
        name: "male face"
        description: "Facial features identifying male person"

  - id: "nudity_topk16"
    name: "Nudity SAE (Top-K 16)"
    
    hyperparameters:
      topk: 16
      learning_rate: 5.0e-4
      warmup_steps: 100000
      auxiliary_loss: 0.03125
      epochs: 2
      batch_size: 4096
      nb_concepts: 40960
    
    model_dir: "models/sd-v1-5/sae/exp32_topk16"
    layer_id: "UNET_UP_1_ATT_1"
    
    concepts:
      - id: "exposed_anus"
        name: "anus"
        description: "Visible anus without clothing coverage"
      - id: "exposed_armpits"
        name: "armpits"
        description: "Uncovered underarm area"
      - id: "exposed_belly"
        name: "belly"
        description: "Bare stomach or abdominal area"
      - id: "exposed_buttocks"
        name: "buttocks"
        description: "Visible buttocks without clothing"
      - id: "exposed_feet"
        name: "feet"
        description: "Bare feet without shoes or socks"
      - id: "exposed_breast"
        name: "female breast"
        description: "Visible female breast without coverage"
      - id: "male_breast"
        name: "male breast"
        description: "Male chest area"
      - id: "exposed_vagina"
        name: "female genitalia"
        description: "Visible female genitalia"
      - id: "exposed_penis"
        name: "male genitalia"
        description: "Visible male genitalia"
      - id: "female_face"
        name: "female face"
        description: "Facial features identifying female person"
      - id: "male_face"
        name: "male face"
        description: "Facial features identifying male person"

  - id: "nudity_topk64"
    name: "Nudity SAE (Top-K 64)"
    
    hyperparameters:
      topk: 64
      learning_rate: 1.0e-3
      warmup_steps: 100000
      auxiliary_loss: 0.0625
      epochs: 2
      batch_size: 4096
      nb_concepts: 46080
    
    model_dir: "models/sd-v1-5/sae/exp36_topk64"
    layer_id: "UNET_UP_1_ATT_1"
    
    concepts:
      - id: "exposed_anus"
        name: "anus"
        description: "Visible anus without clothing coverage"
      - id: "exposed_armpits"
        name: "armpits"
        description: "Uncovered underarm area"
      - id: "exposed_belly"
        name: "belly"
        description: "Bare stomach or abdominal area"
      - id: "exposed_buttocks"
        name: "buttocks"
        description: "Visible buttocks without clothing"
      - id: "exposed_feet"
        name: "feet"
        description: "Bare feet without shoes or socks"
      - id: "exposed_breast"
        name: "female breast"
        description: "Visible female breast without coverage"
      - id: "male_breast"
        name: "male breast"
        description: "Male chest area"
      - id: "exposed_vagina"
        name: "female genitalia"
        description: "Visible female genitalia"
      - id: "exposed_penis"
        name: "male genitalia"
        description: "Visible male genitalia"
      - id: "female_face"
        name: "female face"
        description: "Facial features identifying female person"
      - id: "male_face"
        name: "male face"
        description: "Facial features identifying male person"